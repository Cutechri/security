# Confused?
This document is about my custom Defender Exploit Guard mitigations. Read [this](https://cutechri.xyz/#hardening-exploit-guard) for more info.

# Changelog
*Note: The times are all in the Central European Time (CET) timezone.*

**2022-07-09 11:36 PM**
- Turned off the blocking of untrusted fonts for Grand Theft Auto: San Andreas (gta-sa.exe and gta_sa.exe) due to an incompatibility with SAMP.

**2022-07-08 5:27 AM**
- Fixed a silly mistake where I secured LsaLso.exe (a non existent process) instead of LsaIso.exe (Credential Guard & VBS Key Isolation) because the two letters looked similar. Oopsie.

**2022-06-30 11:38 PM**
- Fixed an incompatibility in the Microsoft Management Console (mmc.exe) which was preventing the Windows Firewall Advanced Settings snap-in from starting.

**2022-06-30 12:44 AM**
- Added mitigations for the Windows Lock Screen (LockApp.exe).

**2022-06-30 12:34 AM**
- Added mitigations for the Windows Security Health Host (SecurityHealthHost.exe), Windows Security Health Service (SecurityHealthService.exe), Defender System Tray (SecurityHealthSystray.exe), Defender UI (SecHealthUI.exe), Windows Aggregator Host (AggregatorHost.exe), and the new Desktop Web Search (DesktopSearchBoxWin32Exe.exe). The `SecurityHealth` related mitigations help protect against Defender mimicking and hijacking.

**2022-06-29 9:13 PM**
- Added mitigations for the System File Checker (sfc.exe), Deployment Image Servicing & Management (dism.exe) and Deployment Image Servicing & Management Host (dismhost.exe) services, to ensure that nothing tampers with the integrity of the system files during a repair or servicing operation.

**2022-06-29 2:54 AM**
- Added mitigations for Defender's command line executable (MpCmdRun.exe).

**2022-06-29 2:39 AM**
- **Major previously work-in-progress mitigations on the NT kernel itself (ntoskrnl.exe) and the Windows Logon Application (winlogon.exe) finally implemented. It is highly recommended to update your file as this improves upon Virtualization-Based Security and prevents a whole other host of kernel related exploits.**

**2022-06-29 2:04 AM**
- Fixed incompatibilities in all Office applications preventing you from signing in due to a 'temporary server error'.

**2022-06-27 7:12 PM**
- Fixed an incompatibility in the command line Registry Editor (reg.exe).

**2022-06-26 7:28 PM**
- Added mitigations for the Microsoft Realtime Network Inspection Service (NisSrv.exe) which can prevent applications from sniffing network information.
- Added mitigations for the Microsoft Software Protection Platform Service (SppSvc.exe), which is a service that protects official Microsoft products (such as OneDrive, Office etc.) from tampering by external programs. These mitigations can help prevent malicious software from bypassing this service.
- Improved mitigations for Windows PowerShell (powershell.exe) and Background Intelligent Transfer Host Administration Utility (bitsadmin.exe), the latter having been recently added to the default list by Microsoft.

**2022-06-24 1:31 AM**
- Addressed an issue where some Service Host (svchost.exe) mitigations would cause issues downloading or updating apps from the Microsoft Store.

**2022-06-22 9:23 PM**
- Added mitigations for Skype (skype.exe).

**2022-06-21 1:04 AM**
- Improved mitigations for the Local Security Authority Subsystem Service (lsass.exe) and Service Host (svchost.exe) in accordance with the latest revision of my security guide.

**2022-06-20 1:48 PM**
- Added mitigations for the Windows D3D10 WARP JIT service (Windows.WARP.JITService.exe).

**2022-06-20 10:31 AM**
- **Added important mitigations for the games Half-Life (hl.exe) and Counter-Strike 1.6 (cstrike.exe), which are vulnerable to client hijacking through remote commands and malware distribution through remote server files.**
- Fixed an incompatibility regarding both of the above games. These games do not play well with Data Execution Prevention (DEP) and thus it has been turned off for both. This is one of those rare cases where DEP may not work.

**2022-06-12 12:03 AM**
- **Deliberately errored the execution of High Contrast (sethc.exe) due to a massive exploit that could allow anybody to invoke it on the Windows logon screen and produce a Console window with Administrator privileges. Note that this will break invoking High Contrast mode, if it wasn't obvious.**

**2022-06-09 11:54 PM**
- Removed mitigations for all Steam related processes due to massive issues. It is recommended to use Default Deny protection for games that could get their update servers compromised, and to defend against potential Steam Web Helper (steamwebhelper.exe) exploits.
- **Added important mitigations for the command line Registry Editor (reg.exe), which can help protect against registry based attacks attempting to bypass Defender in a recent vulnerability.**

**2022-06-08 9:54 PM**
- Fixed RPG Maker games (RPG_RT.exe) being incompatible with mandatory ASLR and thus not executing.
- Added mitigations for Foxit PDF Reader to combat the Folina vulnerability (CVE-2022-30190), due to it not running documents in an AppContainer such as Acrobat Reader and thus being vulnerable.
- Fixed an incompatibility in Java (javaw.exe) preventing Minecraft from opening external programs and webpages.

**2022-05-29 7:47 AM**
- Fixed an incompatibility in MultiMC.

**2022-05-26 9:03 PM**
- Fixed an incompatible mitigation in Java (java.exe) causing crashes on startup.

**2022-05-26 12:06 AM**
- Re-added Windows Audio Device Graph Isolation (audiodg.exe) mitigations and fine-tuned them to work with all audio devices.

**2022-05-25 11:41 PM**
- **Added important mitigations for the clipboard, including the RDP clipboard.**
- Added mitigations for cmproxyd.exe, which is a Windows Sandbox component.

**2022-05-25 10:31 PM**
- Restored a massive amount of mitigations that went missing recently for no good reason, namely Office mitigations.

**2022-05-25 12:00 AM**
- **Significant mitigations against RCE (Remote Code Execution) and ACE (Arbitrary Code Execution) have been applied to the following Adobe products, in accordance to latest vulnerabilities targeting most of their recent versions and earlier (see CVE-2022-24104, CVE-2022-24098, CVE-2022-23187 etc.): Photoshop, Premiere Pro, After Effects, Illustrator, Media Encoder and FrameMaker.**
- Numerous mitigations, primarily against ACE, have been applied to companion processes to most Adobe products, such as CCLibrary.exe, CCXProcess.exe, AdobeIPCBroker.exe and sniffer.exe.
- Important mitigations against Acrobat Reader have been applied.
- Mitigations to Mediaserver.exe, main worker process to ALLMediaServer 1.6, have been applied to combat an ACE vulnerability (CVE-2022-28381).

**2022-05-24 10:54 PM**
- Adjusted most processes' mandatory ASLR mitigation to include disallowing of stripped images, which do not enforce ASLR, improving security.
- Enabled ACG for explorer.exe, and enabled blocking of low integrity & remote images for Bandizip.

**2022-05-21 6:14 PM**
- Added mitigations for Visual Studio Code, Notepad++, Mozilla Thunderbird, Mozilla Firefox, Google Chrome, Vivaldi, MultiMC and Java.
- Added the image dependency integrity validation mitigation for Microsoft Edge.

**2022-05-21 5:12 PM**
- Removed SimExec, CallerCheck and StackPivot mitigations from all processes that utilize ACG due to a previously incorrect configuration (the three mitigations are incompatible with ACG). These mitigations are still utillized in processes that are not compatible with ACG.
- Updated Discord Stable, Discord PTB and Discord Canary mitigations to fix an issue where "Copy Image" was not working.

**2022-05-21 2:35 PM**
- Did some work to address mmc.exe (Group Policy, Services etc.) incompatibilities.

**2022-05-20 10:02 PM**
- Did some major compatibility changes to explorer.exe, dwm.exe and dllhost.exe related to context menu items.
- Modified mitigations for Bandizip to combat a major incompatibility.
- Added mitigations for 7zip, WinRAR, Steam, Steam Web Helper, Steam Service, NVIDIA Container, NVIDIA Control Panel, NVIDIA Share, IObit Unlocker and qBittorrent.

**2022-05-20 5:54 PM**
- Modified ShareX overrides to fix an incompatibility issue.

**2022-05-20 12:00 PM**
- Fixed git bash & GitHub Desktop not being compatible with mandatory ASLR.
- Removed audiodg.exe from the list as it caused issues with some audio devices.

**2022-05-19 8:00 PM**
- Initial release.
- **Contains over a hundred mitigations for a number of critical system and exploitable processes.**
- **Contains a fix for Rockstar Launcher and Social Club Redistributables not being compatible with mandatory ASLR.**
